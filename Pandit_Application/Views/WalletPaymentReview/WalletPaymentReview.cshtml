@model Pandit_ApplicationEntity.RazorpayOrdermodel

@{
    ViewBag.Title = "WalletPaymentReview";
}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
@*@Html.HiddenFor(model => model.amount, new { @id = "hdnamount" })*@
@*@Html.HiddenFor(model => model.id, new { @id = "hdnorderid" })*@
<input type="hidden" value="@Session["rechargetotal"]" id="hdnPayableamt" />
<input type="hidden" value="@Session["PaymentOrderid"]" id="hdnorderid" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<style>

    .modal-contents {
        border: 1px solid #ff7e00;
        padding: 6%;
        border-radius: 3px;
        z-index: 999999;
        opacity: 999999;
        box-shadow: 0 2px 16px 0 #ff7e00;
        border-radius: 6px;
        margin-bottom: 6%;
        min-height: 262px;
        margin: 3px;
    }

    label {
        font-weight: normal;
    }

    .body-main {
        background: #ffffff;
        border-bottom: 10px solid #ff7e00;
        border-top: 10px solid #ff7e00;
        margin-top: 30px;
        margin-bottom: 30px;
        padding: 40px 30px !important;
        position: relative;
        box-shadow: 0 1px 21px #ff7e00;
        font-size: 13px
    }

    .main thead {
        background: #1E1F23;
        color: #fff
    }

    .img {
        height: 100px
    }

    h1 {
        text-align: center
    }
</style>
<!-- hs About Title Start -->
<div class="hs_indx_title_main_wrapper">
    <div class="hs_title_img_overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 full_width">
                <div class="hs_indx_title_left_wrapper">
                    <h2>
                        Review Payment
                    </h2>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 full_width">
                <div class="hs_indx_title_right_wrapper">
                    @*<ul>
                            <li><a href="#">Home</a> &nbsp;&nbsp;&nbsp;> </li>
                            <li>Profiles</li>
                        </ul>*@
                </div>
            </div>
        </div>
    </div>
</div>
<!-- hs About Title End -->
<!-- hs sidebar Start -->
<div class="hs_contact_indx_form_main_wrapper" style="padding-top: 10px;">
    <div class="container">
        @*<div class="modal-contents">*@

        @*<div class="page-header">
                <h1>Invoice Template </h1>
            </div>*@
        <div class="container">
            <div class="row">
                <div class="col-md-8 col-md-offset-2 body-main">
                    <div class="col-md-12">
                        @*<div class="row">
                                <div class="col-md-4"> <img class="img" alt="Invoce Template" src="http://pngimg.com/uploads/shopping_cart/shopping_cart_PNG59.png" /> </div>
                                <div class="col-md-8 text-right">
                                    <h4 style="color: #F81D2D;"><strong>BBBootstrap</strong></h4>
                                    <p>221 ,Baker Street</p>
                                    <p>1800-234-124</p>
                                    <p>example@gmail.com</p>
                                </div>
                            </div> <br />*@
                        <div class="row">
                            <div class="col-md-12 text-center">
                                <input type="hidden" id="hdnbackurl" value="@Session["BackURL"]" />
                                @*<h2>Review Payment</h2>*@
                                @*<h5>04854654101</h5>*@
                            </div>
                        </div> <br />
                        <div>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>
                                            <h5 style="font-size:15px;font-weight:600;    color: #ff7e00;">Description</h5>
                                        </th>
                                        <th>
                                            <h5 style="font-size:15px;font-weight:600;    color: #ff7e00;">Amount</h5>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="col-md-9">Wallet Recharge</td>
                                        <td class="col-md-3"><i class="fas fa-rupee-sign" area-hidden="true"></i>$@Session["Amount1"].ToString() </td>
                                    </tr>


                                    <tr>
                                        <td class="col-md-9">18% GST</td>
                                        <td class="col-md-3"><i class="fas fa-rupee-sign" area-hidden="true"></i> $@Session["gstamtC_C"].ToString() </td>
                                    </tr>

                                    @*<tr>
                                            <td class="text-right">
                                                <p> <strong>Shipment and Taxes:</strong> </p>
                                                <p> <strong>Total Amount: </strong> </p>
                                                <p> <strong>Discount: </strong> </p>
                                                <p> <strong>Payable Amount: </strong> </p>
                                            </td>
                                            <td>
                                                <p> <strong><i class="fas fa-rupee-sign" area-hidden="true"></i> 500 </strong> </p>
                                                <p> <strong><i class="fas fa-rupee-sign" area-hidden="true"></i> 82,900</strong> </p>
                                                <p> <strong><i class="fas fa-rupee-sign" area-hidden="true"></i> 3,000 </strong> </p>
                                                <p> <strong><i class="fas fa-rupee-sign" area-hidden="true"></i> 79,900</strong> </p>
                                            </td>
                                        </tr>*@
                                    <tr style="color: #F81D2D;">
                                        <td class="text-right">
                                            <h4><strong>Total Payable Amount:</strong></h4>
                                        </td>
                                        <td class="text-left">
                                            <h4><strong><i class="fas fa-rupee-sign" area-hidden="true"></i> $@Session["rechargetotal"].ToString()</strong></h4>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <div class="col-md-12">

                                <div class="hs_contact_indx_form_btn">
                                    @*<ul>
                                            <li><a href="#">Pay Now</a></li>
                                        </ul>*@
                                    <button id="rzp-button1" class="btn btn-primary">Pay</button>
                                </div>

                                @*<p><b>Date :</b> 6 June 2019</p> <br />
                                    <p><b>Signature</b></p>*@
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        @*</div>*@
    </div>
</div>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>

    var hdnorderid = "";
    var hdnamount = "";
    $(document).ready(function () {
        debugger
        hdnorderid = $("#hdnorderid").val();
        hdnamount = $("#hdnPayableamt").val();
        hdnurl = $("#hdnbackurl").val();
        var options = {

            "key": "rzp_live_Ks5ay3Dx0yIaEi", // Enter the Key ID generated from the Dashboard
            "amount": "" + hdnamount + "", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            "currency": "INR",
            "name": "Astro Houz OPC Private Limited",
            "description": "Test Transaction",
            "image": "http://localhost:60476/images/Logopayment.png",
            "order_id": hdnorderid, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
            "handler": function (response) {
                debugger
                $.ajax({
                    url: "/AddWalletMoney/GetPaymentid?PaymentID=" + response.razorpay_payment_id + "&OrderID=" + response.razorpay_order_id + "",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    success: function (response) {
                        debugger
                        if (response != null || response != "") {
                            //window.history.back();
                            window.location.href = hdnurl;
                            //window.location.reload();
                        }
                        else {

                            alert("Error Occured");


                        }
                    },
                    error: function (err) {

                        alert("Error Occured");
                    }
                });
                //alert(response.razorpay_payment_id);
                //alert(response.razorpay_order_id);
                //alert(response.razorpay_signature)
            },
            "prefill": {
                //"name": "Ragini Bhandari",
                //"email": "iamragini23@gmail.com",
                //"contact": "7209860586"
            },

            "notes": {
                "address": "Razorpay Corporate Office"
            },
            "theme": {
                "color": "#FF6A00"
            }
        };
        var rzp1 = new Razorpay(options);
        rzp1.on('payment.failed', function (response) {
            debugger
            alert(response.error.code);
            alert(response.error.description);
            alert(response.error.source);
            alert(response.error.step);
            alert(response.error.reason);
            alert(response.error.metadata.order_id);
            alert(response.error.metadata.payment_id);
        });
        document.getElementById('rzp-button1').onclick = function (e) {
            debugger
            rzp1.open();
            e.preventDefault();
        }
    })

</script>
